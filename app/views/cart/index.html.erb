<div class="container">
  <h1>Cart Items</h1>
  <table class="cart">
    <thead>
    <tr>
      <th>Image</th>
      <th>Item</th>
      <th>Price</th>
      <th>Operation</th>
    </tr>
    </thead>
    <tbody>
    <% if @products.length == 0 %>
        <tr>
          <td colspan="4" style="color: #AAA">No items in cart</td>
        </tr>
    <% end %>
    <% @products.each do |product| %>
        <tr>
          <td><%= image_tag product.image.thumb.url %></td>
          <td><%= product.name %></td>
          <td>CND <%= number_to_currency(product.price) %></td>
          <td>
            <%= link_to remove_from_cart_path(product.id), method: :post, class: 'button', data: {confirm: "Remove #{product.name}?"} do %>
                <span class="fa fa-trash"></span>
            <% end %>
          </td>
        </tr>
    <% end %>
    </tbody>
    <tfoot>
    <tr>
      <td colspan="4"><strong>Total Items:</strong> <%= @products.length %></td>
    </tr>
    <tr>
      <td colspan="4"><strong>Subtotal:</strong> <%= number_to_currency(@total) %></td>
    </tr>
    </tfoot>
  </table>

  <% if @customer.errors.any? %>
      <div id="error_explanation">
        <h3><%= pluralize(@customer.errors.count, 'error') %>:</h3>

        <ul>
          <% @customer.errors.full_messages.each do |message| %>
              <li><%= message %></li>
          <% end %>
        </ul>
      </div>
  <% end %>

  <%= form_for(@customer, html: { class: 'order' }) do |f| %>
    <fieldset>
      <legend>Order Information</legend>
      <ul>
        <li>
          <%= f.label :first_name %>
          <%= f.text_field :first_name, required: true, placeholder: 'John' %>
        </li>
        <li>
          <%= f.label :last_name %>
          <%= f.text_field :last_name, required: true, placeholder: 'Smith' %>
        </li>
        <li>
          <%= f.label :province_id %>
          <select id="customer_province_id" name="customer[province_id]" required="required">
            <option value="">Please select a province</option>
            <%= options_from_collection_for_select(@provinces, 'id', 'name') %>
          </select>
        </li>
        <li>
          <%= f.label :city %>
          <%= f.text_field :city, required: true, placeholder: 'Winnipeg' %>
        </li>
        <li>
          <%= f.label :address %>
          <%= f.text_field :address, required: true, placeholder: 'Box 770' %>
        </li>
        <li>
          <%= f.label :postal_code %>
          <%= f.text_field :postal_code, required: true, placeholder: 'R0A0T0' %>
          <!-- , pattern: '^([ABCEGHJKLMNPRSTVXY]\d){3}$' -->
        </li>
        <li>
          <%= f.label :email %>
          <%= email_field 'customer', :email, required: true, placeholder: 'fake@example.com' %>
        </li>
        <li>
          <%= f.submit 'Checkout', disabled: !session[:cart].any? %>
        </li>
      </ul>
    </fieldset>
  <% end %>
</div>